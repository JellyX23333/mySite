<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>about me</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="favicon.ico" />

  <!-- Vue 3 CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
</head>

<body>
<div id="app">

  <h1 style="float:right;margin-right:10px;">about me</h1>

  <!-- Top icons -->
  <ul style="list-style:none; padding:0; margin:0; display:flex; align-items:center; gap:10px;">
    <li>
      <button @click="changeLanguage" style="background:transparent;border:none;">
        <img src="https://cdn3.iconfinder.com/data/icons/design-tools-15/24/_translation-1024.png"
             width="30">
      </button>
    </li>

    <li>
      <a href="https://github.com/jellyx23333">
        <img src="https://github.githubassets.com/assets/GitHub-Mark-ea2971cee799.png"
             width="30">
      </a>
    </li>

    <li>
      <a class="tooltip-wrapper" style="position:relative;">
        <img src="https://cdn2.iconfinder.com/data/icons/email-line-2/48/email_link_mail-512.png"
             width="30">
        <span class="tooltip">izeping#outlook.com</span>
      </a>
    </li>

    <li>
      <a href="https://www.linkedin.com/in/zeping-xu-052b13356/">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR6KyW5WYCdoJ32KzNbJH6NMm43byKYpZuo7g&s"
             width="30">
      </a>
    </li>

    <li>
      <label class="switch">
        <input type="checkbox" v-model="darkMode" @change="toggleDarkMode">
        <span class="slider round"></span>
      </label>
    </li>
  </ul>

  <div style="clear:both;"></div>

  <!-- Skills -->
  <div class="block">
    <h2>Skills</h2>
    <ul>
      <li>Molecular Biology</li>
      <li>Cell Biology</li>
      <li>Statistical Analysis</li>
      <li>Python, Lua, Julia, R & MATLAB</li>
      <li>Arduino</li>
      <li>Linux system</li>
      <li>Barista</li>
      <li>Japanese (N2)</li>
      <li>Mandarin Chinese (native)</li>
      <li>Wu Chinese (native)</li>
    </ul>
  </div>

  <!-- Projects -->
  <div class="block">
    <h2>Projects</h2>

    <h3>Completed</h3>
    <ul style="list-style:none">

      <li>
        <span>personal website </span>
        <span class="censored">this</span>
      </li>

      <!-- Typed projects -->
      <li v-for="(p, i) in projects" v-if="showMore" :key="i">
        <span class="typing">{{ p.typed }}</span>

        <a v-if="p.typed === p.text" :href="p.link" target="_blank">
          <img src="https://cdn0.iconfinder.com/data/icons/pixon-1/24/Link_hyperlink-1024.png"
               width="18" style="margin-left:6px;">
        </a>
      </li>

      <li>
        <button @click="toggleProjects"
                style="background:transparent;border:none;font-size:17px;color:#5a788a;cursor:pointer">
          {{ showMore ? "hide" : "more ..." }}
        </button>
      </li>

    </ul>
  </div>
    <hr>
    <div class="block">
        <h2>Education</h2>
        <ul>
            <li>Bachelor of Sci, University of Melbourne, Currently Enrolled</li>
            <li>Higher School Certificate, Epping Boys High School, Graduated 2023</li>
        </ul>
    </div>

    <hr>
    <div class="block">
        <h2>Career history</h2>
        <ul>
            <li>Assistant Restaurant Manager at Young Barons Woy Woy, Dec.2022 - Dec.2023 <a href="https://www.youngbarons.com/"><img src="https://cdn0.iconfinder.com/data/icons/pixon-1/24/Link_hyperlink-1024.png" width="20" height="20" alt="hyperlink icon"></a></li>
            <li>Kitchenhand at Burwood Night Market Takoyaki, Jan.2020 – Mar. 2020</li>
            <li>Cleaner at Queen bakery in Chatswood, Jun.2019 – Dec. 2019</li>
        </ul>
    </div>

    <hr>
    <div class="block">
        <h2>Interests</h2>
        <ul>
            <li>Hiking</li>
            <li>Climbing</li>
            <li>Diving</li>
            <li>Photography</li>
            <li>Pottery</li>
        </ul>
    </div>

    <hr>
    <div class="block">
        <h2>Achievements & Community Engagement</h2>
        <ul>
            <li>Duke of Edinburg (Gold)</li>
            <li>Bush Regeneration Volunteer, Jan.2022-Feb.2024</li>
        </ul>
    </div>
    <div class="commentBlock">
      <p>Comments</p>
      <div class="newComment">
        <input type="text" placeholder="Name" v-model="name" style="display:block;margin-bottom:10px;">
        <input type="email" placeholder="Email" v-model="email" style="display:block;margin-bottom:10px;">
        <textarea placeholder="Comment" v-model="comment" style="display:block;width:100%;height:4em;margin-bottom:10px;"></textarea>
        <button @click="addComment">Submit</button>
      </div>
      <div class="comment" v-for="comment in comments">
        <p><strong>{{ comment.name }}:</strong> {{ comment.comment }}</p>
      </div>
    </div>
</div>

<!-- Vue logic -->
<script>
const { createApp, ref, onMounted } = Vue

createApp({
  setup() {
    const showMore = ref(false)
    const darkMode = ref(localStorage.getItem("darkMode") === "enabled")

    const projects = ref([
      {
        text: "bilibili video",
        link: "https://github.com/JellyX23333/BilibiliVideoChanger",
        typed: ""
      },
      {
        text: "japanese practice",
        link: "https://github.com/JellyX23333/HiraganaKanji-Practice",
        typed: ""
      }
    ])

    function typeProject(index, speed = 40) {
      const p = projects.value[index]
      p.typed = ""
      let i = 0

      const timer = setInterval(() => {
        p.typed += p.text[i]
        i++
        if (i >= p.text.length) clearInterval(timer)
      }, speed)
    }

    function toggleProjects() {
      showMore.value = !showMore.value

      if (showMore.value) {
        projects.value.forEach(p => p.typed = "")
        typeProject(0)
        setTimeout(() => typeProject(1), 400)
      }
    }

    function toggleDarkMode() {
      document.documentElement.classList.toggle("dark-mode", darkMode.value)
      localStorage.setItem("darkMode", darkMode.value ? "enabled" : "disabled")
    }

    function changeLanguage() {
      const lang = document.documentElement.lang
      window.location.href = lang === "en" ? "index.zh.html" : "index.html"
    }

    onMounted(() => {
      if (darkMode.value) {
        document.documentElement.classList.add("dark-mode")
      }
    })

    // push comments
    function addComment() {
      const comment = {
        name: name.value,
        email: email.value,
        comment: comment.value
      }

      const url = "/comment"
      const xhr = new XMLHttpRequest()
      xhr.open("POST", url)
      xhr.setRequestHeader('Content-Type', 'application/json')
      xhr.send(JSON.stringify(comment))
      
      comments.value.push(comment)

      name.value = ""
      email.value = ""
      comment.value = ""
    }

    // fetch comment on mount
    // 1. Create reactive data
    const comments = ref([]);

    // 2. Define the fetch function
    const fetchComments = async () => {
      try {
        // Using 'foo' as requested
        const response = await fetch('/comment');
        
        if (!response.ok) {
           throw new Error(`Error: ${response.status}`);
        }

        const data = await response.json();
        comments.value = data; 
      } catch (error) {
        console.error("Failed to fetch:", error);
      }
    };

    // 3. Run fetch when app mounts
    onMounted(() => {
      console.log('Fetching comments...');
      fetchComments();
    });

    return {
      showMore,
      projects,
      darkMode,
      toggleProjects,
      toggleDarkMode,
      changeLanguage,
      addComment,
      comments,
      fetchComments
    }
  }
}).mount("#app")
</script>

</body>
</html>

